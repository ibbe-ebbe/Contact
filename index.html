<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Styled Sheet Data</title>

<style>
  body {
    font-family: Inter, Arial, sans-serif;
    background: #0f172a;
    color: #e5e7eb;
    padding: 20px;
  }

  h1 {
    margin-bottom: 16px;
    font-size: 22px;
  }

  table {
    width: 100%;
    border-collapse: collapse;
    background: #020617;
    border-radius: 10px;
    overflow: hidden;
  }

  thead {
    background: #020617;
  }

  th {
    text-align: left;
    padding: 12px;
    font-size: 13px;
    text-transform: uppercase;
    letter-spacing: 0.05em;
    color: #94a3b8;
    border-bottom: 1px solid #1e293b;
  }

  td {
    padding: 12px;
    border-bottom: 1px solid #1e293b;
    font-size: 14px;
  }

  tr:hover {
    background: #020617;
  }

  .badge {
    padding: 4px 10px;
    border-radius: 999px;
    font-size: 12px;
    font-weight: 600;
    display: inline-block;
  }

  .active {
    background: #064e3b;
    color: #6ee7b7;
  }

  .closed {
    background: #7f1d1d;
    color: #fecaca;
  }

  @media (max-width: 768px) {
    table {
      font-size: 12px;
    }
  }
</style>
</head>

<body>

<h1>ðŸ“Š Google Sheet Data</h1>
<div id="table-container">Loadingâ€¦</div>

<script>
const sheetID = "1prn2K23XHjv_z7l0VG_Iy762c-O4HsklbaEbFye2Ly0";
const sheetName = "Sheet1"; // change if needed

fetch(`https://docs.google.com/spreadsheets/d/${sheetID}/gviz/tq?tqx=out:json&sheet=${sheetName}`)
  .then(res => res.text())
  .then(text => {
    const json = JSON.parse(text.substring(47).slice(0, -2));
    const cols = json.table.cols.map(c => c.label);
    const rows = json.table.rows;

    let html = "<table><thead><tr>";
    cols.forEach(col => html += `<th>${col}</th>`);
    html += "</tr></thead><tbody>";

    rows.forEach(r => {
      html += "<tr>";
      r.c.forEach(cell => {
        let value = cell ? cell.v : "";

        // example: status badge
        if (typeof value === "string" && value.toLowerCase() === "active") {
          value = `<span class="badge active">Active</span>`;
        }
        if (typeof value === "string" && value.toLowerCase() === "closed") {
          value = `<span class="badge closed">Closed</span>`;
        }

        html += `<td>${value}</td>`;
      });
      html += "</tr>";
    });

    html += "</tbody></table>";
    document.getElementById("table-container").innerHTML = html;
  });
</script>

</body>
</html>
